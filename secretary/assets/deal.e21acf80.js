import"./base.1e933585.js";import{E as su}from"./el-overlay.518f1a29.js";import{E as ou}from"./el-date-picker.a5c292ff.js";/* empty css                 */import"./el-scrollbar.79423c53.js";import"./el-popper.d46c6f11.js";import{E as nu}from"./el-button.b4eca325.js";import{E as ru}from"./el-pagination.531c4a90.js";import{E as du,a as G}from"./el-checkbox.48cd4d17.js";import{E as iu,a as vu}from"./el-select.111acb84.js";import{E as pu,a as mu}from"./el-col.e8e68218.js";import{_ as fu,d as Fu,M as gu,c as Eu,C as Au,D as bu,r as o,G as Cu,a$ as cu,o as r,l as g,f as w,w as a,g as l,j as p,H as x,I as M,B as E,t as L,q as N,h as B,aV as Bu,b0 as Du}from"./index.9aa6671f.js";import{m as O}from"./index.eef4dd4b.js";import{E as S}from"./index.7c4906df.js";import"./use-dialog.12574f67.js";import"./scroll.9fd9eb4f.js";import"./index.025ab758.js";function _u(D){return O.get({url:"/api/process/filter",params:{processId:D}})}function yu(D){return O.post({url:"/api/process/updateBatch",data:D})}const Vu={class:"container"},ku={key:1,class:"mobile-head"},wu={class:"Main"},xu={class:"modal"},Mu={key:0,style:{display:"flex"}},Su={class:"modal-tail"},zu=Fu({__name:"deal",setup(D){const J=gu(),R=Eu(()=>J.isMobile);Au(),bu();const n=o(0),i=o(0);o("");const _=o(!1),z=o(!0),Y=o(""),h=[{label:"\u672A\u63D0\u4EA4\u5165\u515A\u7533\u8BF7\u4E66",value:0},{label:"\u5165\u515A\u7533\u8BF7\u4EBA",value:1},{label:"\u5165\u515A\u79EF\u6781\u5206\u5B50",value:2},{label:"\u53D1\u5C55\u5BF9\u8C61",value:3},{label:"\u4E2D\u5171\u9884\u5907\u515A\u5458",value:4}],A=[[{label:"\u5165\u515A\u7533\u8BF7\u4EBA",value:0,stage:1}],[{label:"\u7FA4\u56E2\u7EC4\u7EC7\u63A8\u4F18",value:0,stage:3},{label:"\u652F\u59D4\u4F1A\u5BA1\u8BAE\u5E76\u4E0A\u62A5\u652F\u90E8\u515A\u59D4\u7EC4\u7EC7",value:1,stage:5},{label:"\u5165\u515A\u79EF\u6781\u5206\u5B50",value:2,stage:6}],[{label:"\u786E\u5B9A\u57F9\u517B\u8054\u7CFB\u4EBA",value:0,stage:9},{label:"\u652F\u90E8\u8003\u5BDF",value:1,stage:10},{label:"\u542C\u53D6\u515A\u5458\u610F\u89C1",value:2,stage:11},{label:"\u5F81\u6C42\u7FA4\u4F17\u610F\u89C1",value:3,stage:12},{label:"\u5F81\u6C42\u515A\u5C0F\u7EC4\u3001\u8054\u7CFB\u4EBA\u610F\u89C1",value:4,stage:13},{label:"\u652F\u90E8\u4F1A\u8BA8\u8BBA\u5E76\u4E0A\u62A5\u4E0A\u7EA7\u515A\u59D4\u5907\u6848",value:5,stage:14},{label:"\u53D1\u5C55\u5BF9\u8C61",value:6,stage:15}],[{label:"\u786E\u5B9A2\u540D\u6B63\u5F0F\u515A\u5458\u4E3A\u4ECB\u7ECD\u4EBA",value:0,stage:16},{label:"\u653F\u5BA1",value:1,stage:17},{label:"\u901A\u8FC7\u53D1\u5C55\u5BF9\u8C61\u515A\u6821\u57F9\u8BAD",value:2,stage:19},{label:"\u6750\u6599\u9F50\u5168",value:3,stage:20},{label:"\u652F\u90E8\u7EFC\u5408\u5BA1\u67E5",value:4,stage:21},{label:"\u4E0A\u7EA7\u515A\u59D4\u9884\u5BA1\u5E76\u516C\u793A",value:5,stage:22},{label:"\u515A\u5458\u53D1\u5C55\u5927\u4F1A",value:6,stage:24},{label:"\u515A\u59D4\u8C08\u8BDD\u3001\u5BA1\u6279",value:7,stage:25},{label:"\u62A5\u518D\u4E0A\u4E00\u7EA7\u515A\u59D4\u7EC4\u7EC7\u90E8\u95E8\u5907\u6848",value:8,stage:26},{label:"\u4E2D\u5171\u9884\u5907\u515A\u5458",value:9,stage:27}],[{label:"\u5165\u515A\u5BA3\u8A93",value:0,stage:28},{label:"\u53C2\u52A0\u7EC4\u7EC7\u751F\u6D3B",value:1,stage:31},{label:"\u652F\u90E8\u6309\u5B63\u5EA6\u8FDB\u884C\u8003\u5BDF",value:2,stage:32},{label:"\u5F81\u6C42\u515A\u5458\u3001\u7FA4\u4F17\u610F\u89C1",value:3,stage:34},{label:"\u542C\u53D6\u515A\u5C0F\u7EC4\u3001\u4ECB\u7ECD\u4EBA\u610F\u89C1",value:4,stage:35},{label:"\u8F6C\u6B63\u516C\u793A",value:5,stage:36},{label:"\u8F6C\u6B63\u5927\u4F1A",value:6,stage:37},{label:"\u515A\u59D4\u5BA1\u6279",value:7,stage:38},{label:"\u515A\u5458\u4E66\u8BB0\u8C08\u8BDD",value:8,stage:39},{label:"\u4E2D\u5171\u515A\u5458",value:9,stage:40}]],$=[{label:"\u9012\u4EA4\u5165\u515A\u7533\u8BF7\u4E66",value:0,stage:0},{label:"\u7FA4\u56E2\u7EC4\u7EC7\u63A8\u4F18",value:1,stage:3},{label:"\u5165\u515A\u79EF\u6781\u5206\u5B50",value:4,stage:6},{label:"\u53D1\u5C55\u5BF9\u8C61",value:8,stage:15},{label:"\u653F\u5BA1",value:2,stage:17},{label:"\u515A\u5458\u53D1\u5C55\u5927\u4F1A",value:8,stage:24}],y=o([]),F=o([]),K=o(),U=o([]),m=o(15);let V=o([]),T=o(0),d=o(1);const b=async s=>{s&&(i.value=0);let u=await _u(A[n.value][i.value].stage);u.code===0?(V.value=u.data,T.value=u.data.length,y.value=V.value.slice((d.value-1)*m.value,d.value*m.value)):S.error(u.msg+":"+u.code)},I=async()=>{F.value=U.value,z.value=!0;for(let s of $)if(A[n.value][i.value].stage==s.stage){P();return}F.value.forEach(s=>{s.passAt=""}),H(!1)},Q=s=>{F.value=[s],z.value=!1;for(let u of $)if(A[n.value][i.value].stage==u.stage){P();return}F.value.forEach(u=>{u.passAt=""}),H(!1)},H=async s=>{if(s){for(let v of F.value)if(!v.passAt){S.error("\u4E0D\u80FD\u4E3A\u7A7A");return}}let u=[];F.value.forEach(v=>{u.push({userId:v.id,progressId:A[n.value][i.value].stage,status:1,passAt:v.passAt})});let t=await yu(u);t.code==0?(S.success("\u4FEE\u6539\u6210\u529F"),b(!1),eu()):S.error(t.msg+":"+t.code)},W=()=>{y.value=V.value.slice((d.value-1)*m.value,d.value*m.value)},X=()=>{y.value=V.value.slice((d.value-1)*m.value,d.value*m.value)};Cu(()=>{b(!0)});const Z=s=>{U.value=s},uu=()=>{U.value.forEach(s=>{s.passAt=Y.value})},P=()=>{_.value=!0},eu=()=>{_.value=!1};return(s,u)=>{const t=pu,v=iu,k=vu,C=mu,c=nu,f=du,lu=ru,au=cu,j=ou,tu=su;return r(),g("div",Vu,[R.value?(r(),g("div",ku,[l(t,{span:24,class:"headbar",style:{"margin-bottom":"10px"}},{default:a(()=>[l(C,{style:{width:"100%","align-items":"center"}},{default:a(()=>[l(t,{span:6,class:"headfont"},{default:a(()=>u[18]||(u[18]=[p("span",null,"\u5F53\u524D\u9636\u6BB5:",-1)])),_:1}),l(t,{span:18},{default:a(()=>[l(k,{modelValue:n.value,"onUpdate:modelValue":u[5]||(u[5]=e=>n.value=e),class:"m-2",placeholder:"Select",onChange:u[6]||(u[6]=e=>b(!0))},{default:a(()=>[(r(),g(x,null,M(h,e=>l(v,{class:"option",key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(t,{span:24,class:"headbar"},{default:a(()=>[l(C,{style:{width:"100%","align-items":"center"}},{default:a(()=>[l(t,{span:6},{default:a(()=>u[19]||(u[19]=[p("span",null,"\u671F\u671B\u9636\u6BB5:",-1)])),_:1}),l(t,{span:18},{default:a(()=>[l(k,{modelValue:i.value,"onUpdate:modelValue":u[7]||(u[7]=e=>i.value=e),class:"m-2",placeholder:"Select",onChange:u[8]||(u[8]=e=>b(!1))},{default:a(()=>[(r(!0),g(x,null,M(A[n.value],e=>(r(),w(v,{class:"option",key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(t,{span:24},{default:a(()=>[l(c,{style:{width:"100%","font-size":"16px","margin-top":"10px"},color:"#c7242f",onClick:u[9]||(u[9]=e=>I()),disabled:n.value===0},{default:a(()=>u[20]||(u[20]=[E(" \u901A\u8FC7\u9009\u4E2D\u6210\u5458 ")])),_:1},8,["disabled"])]),_:1})])):(r(),w(C,{key:0,class:"head"},{default:a(()=>[l(t,{span:10,class:"headbar"},{default:a(()=>[l(C,{style:{width:"100%","align-items":"center"}},{default:a(()=>[l(t,{span:6,class:"headfont"},{default:a(()=>u[15]||(u[15]=[p("span",null,"\u5F53\u524D\u9636\u6BB5 ",-1)])),_:1}),l(t,{span:15},{default:a(()=>[l(k,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=e=>n.value=e),class:"m-2",placeholder:"Select",onChange:u[1]||(u[1]=e=>b(!0))},{default:a(()=>[(r(),g(x,null,M(h,e=>l(v,{class:"option",key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(t,{span:10,class:"headbar"},{default:a(()=>[l(C,{style:{width:"100%","align-items":"center"}},{default:a(()=>[l(t,{span:7},{default:a(()=>u[16]||(u[16]=[p("span",null,"\u6B32\u901A\u8FC7\u7684\u9636\u6BB5 ",-1)])),_:1}),l(t,{span:10},{default:a(()=>[l(k,{modelValue:i.value,"onUpdate:modelValue":u[2]||(u[2]=e=>i.value=e),class:"m-2",placeholder:"Select",onChange:u[3]||(u[3]=e=>b(!1))},{default:a(()=>[(r(!0),g(x,null,M(A[n.value],e=>(r(),w(v,{class:"option",key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t,{span:7},{default:a(()=>[l(c,{style:{width:"100%","font-size":"14px","margin-left":"10px"},color:"#c7242f",onClick:u[4]||(u[4]=e=>I()),disabled:n.value===0},{default:a(()=>u[17]||(u[17]=[E(" \u901A\u8FC7\u9009\u4E2D\u6210\u5458 ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})),p("div",wu,[l(B(G),{ref_key:"multipleTableRef",ref:K,data:y.value,style:{width:"100%",height:"100%"},"header-cell-style":{background:"#FFF8F9",color:"#2F2F2F"},onSelectionChange:Z},{default:a(()=>[l(f,{type:"selection"}),l(f,{label:"\u59D3\u540D"},{default:a(e=>[E(L(e.row.userName),1)]),_:1}),R.value?N("v-if",!0):(r(),w(f,{key:0,property:"sno",label:"\u5B66\u53F7","class-name":"son6"})),l(f,{property:"identity",label:"\u5F53\u524D\u9636\u6BB5"},{default:a(()=>[E(L(h[n.value].label),1)]),_:1}),l(f,{label:"\u64CD\u4F5C"},{default:a(e=>[l(c,{style:{color:"#21b339","font-size":"10px"},link:"",onClick:q=>Q(e.row)},{default:a(()=>u[21]||(u[21]=[E("\u901A\u8FC7")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(au,{locale:B(Du),class:"tail"},{default:a(()=>[l(lu,{small:"",class:"el-pagination","current-page":B(d),"onUpdate:currentPage":u[10]||(u[10]=e=>Bu(d)?d.value=e:d=e),"page-size":m.value,"onUpdate:pageSize":u[11]||(u[11]=e=>m.value=e),style:{margin:"20px"},background:"",layout:"total, ->,sizes, prev, pager, next, jumper",total:B(T),onSizeChange:W,onCurrentChange:X},null,8,["current-page","page-size","total"])]),_:1},8,["locale"]),N("--------------------------------------\u5F39\u7A97-----------------------------------------"),l(tu,{modelValue:_.value,"onUpdate:modelValue":u[14]||(u[14]=e=>_.value=e),title:"\u8BF7\u586B\u5199\u4EE5\u4E0B\u6210\u5458\u53D8\u66F4\u65F6\u95F4\uFF1A",class:"popup"},{default:a(()=>[p("div",xu,[z.value?(r(),g("div",Mu,[u[23]||(u[23]=p("div",{class:"font-4"},"\u6279\u91CF\u586B\u5199\uFF1A",-1)),l(j,{modelValue:Y.value,"onUpdate:modelValue":u[12]||(u[12]=e=>Y.value=e),type:"datetime",size:"small",format:"YYYY-MM-DD-HH:mm","value-format":"YYYY-MM-DDTHH:mm:ss.sss"},null,8,["modelValue"]),l(c,{color:"#c7242f",style:{width:"50px",height:"24px"},onClick:uu},{default:a(()=>u[22]||(u[22]=[E("\u586B\u5199")])),_:1})])):N("v-if",!0),l(B(G),{style:{width:"90%",margin:"20px"},"max-height":"50vh",size:"small","cell-style":{padding:"2px",fontSize:"13px"},data:F.value,"header-cell-style":{background:"#FFF8F9",color:"#2F2F2F"}},{default:a(()=>[l(f,{prop:"userName",label:"\u59D3\u540D","min-width":"30%"}),l(f,{prop:"sno",label:"\u5B66\u53F7","min-width":"45%"}),l(f,{label:"\u72B6\u6001\u53D8\u66F4\u65F6\u95F4",prop:"passAt"},{default:a(e=>[l(j,{type:"datetime",size:"small",modelValue:e.row.passAt,"onUpdate:modelValue":q=>e.row.passAt=q,format:"YYYY-MM-DD-HH:mm","value-format":"YYYY-MM-DDTHH:mm:ss.sss"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"]),p("div",Su,[l(c,{color:"#c7242f",onClick:u[13]||(u[13]=e=>H(!0)),style:{"font-size":"14px"}},{default:a(()=>u[24]||(u[24]=[E("\u786E\u8BA4\u66F4\u6539")])),_:1}),u[25]||(u[25]=p("div",{style:{color:"#c7242f","margin-top":"5px"}}," *\u672C\u64CD\u4F5C\u65E0\u6CD5\u56DE\u9000\uFF0C\u8BF7\u786E\u8BA4\u65E0\u8BEF\u540E\u518D\u64CD\u4F5C ",-1))])])]),_:1},8,["modelValue"])])}}});var Qu=fu(zu,[["__scopeId","data-v-cce58c1e"],["__file","C:/Users/77/Desktop/party-building1/party-building-secretary/src/views/pages/deal.vue"]]);export{Qu as default};
